steps:
  #- label: 'stack rebuild'
  #  env:
  #    AWS_REGION: us-west-1
  #    S3_BUCKET: appveyor-ci-cache
  #    CACHE_S3_MAX_SIZE: 2500MB
  #    STACK_ROOT: "/build/cardano-prelude.stack"
  #  command:
  #    # cache-s3 needs a build directory that is the same across all buildkite agents.
  #    # so copy the source into /build/cardano-prelude
  #    - "rm -rf /build/cardano-prelude"
  #    - "cp -R . /build/cardano-prelude"
  #    - "cd /build/cardano-prelude"
  #    - "nix-build scripts/buildkite -o stack-rebuild"
  #    - "./stack-rebuild"
  #  agents:
  #    system: x86_64-linux

  - label: 'check-cabal-project'
    command: 'nix-build lib.nix -A iohkNix.checkCabalProject -o check-cabal-project.sh && ./check-cabal-project.sh'
    agents:
      system: x86_64-linux

  #- label: 'stack-cabal-sync'
  #  command: 'nix-shell scripts/buildkite/stack-cabal-sync.nix --run scripts/buildkite/stack-cabal-sync.sh'
  #  agents:
  #    system: x86_64-linux

  #- label: 'release.nix'
  #  command: 'nix-build -A check-hydra -o check-hydra.sh && ./check-hydra.sh'
  #  agents:
  #    system: x86_64-linux


  #- label: 'dependencies-at-master'
  #  command: 'ci/check-dependencies-merged-to-master.sh'
  #  agents:
  #    system: x86_64-linux

  #- label: 'brittany'
  #  command:
  #    - "nix-build scripts/brittany -o check-brittany"
  #    - "./check-brittany"
  #  agents:
  #    system: x86_64-linux
